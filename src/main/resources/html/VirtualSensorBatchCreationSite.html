<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <title>Virtual Sensors Batch Creation</title>
    <link href="../style/css/semantic.css" rel="stylesheet" type="text/css" />
    <link href="../style/css/semantic.min.css" rel="stylesheet" type="text/css"/>
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Open+Sans:300italic,400,300,700'
          rel='stylesheet' type='text/css'>

    <style type="text/css">
        :not(i){
            font-family: 'Open Sans', sans-serif;
        }

        *{
            font-size: 13px;
        }
    </style>
</head>

<body>
    <div class="ui one column page grid">
        <div class="column">
            <h2 class="ui dividing black header">
                <img class="ui small right floated image" src="/style/images/ssp.png"/>
                Smart Service Proxy
            </h2>

            <div class="ui tiered menu">
                <div class="menu" id="menutier1">
                    <a class="active item" id="mainPageBtn">
                        <i class="home icon"></i>
                        Main Page
                    </a>
                    <a class="item" id="backendsBtn">
                        <i class="grid layout icon"></i>
                        Backends
                    </a>
                    <a class="item">
                        <i class="search icon"></i>
                        &nbsp;SPARQL Search
                    </a>
                </div>

                <div class="ui sub menu" id="menutier2">
                    <a class="item">&nbsp;</a>
                </div>

            </div>


            <div class="ui segment">
                <h4 class="ui top attached header">
                    Create Virtual Sensors from XML file
                </h4>

                <div class="ui segment attached">
                    <p>
                        Choose an XML file from your local filesystem which is valid against
                        <a href="http://media.itm.uni-luebeck.de/people/kleine/xsd/slse/jaxb/slse.xsd">
                            this schema.
                        </a>
                    </p>
                    <form action="./virtual-sensor-batch-creation.html" method="post" enctype="multipart/form-data"
                          class="ui form">

                        <div class="ui action input" style="width:350px">
                            <input type="text" placeholder="Choose XML file..." name="filename" id="filename"
                                   readonly="readonly"/>

                            <label for="fldHiddenFileInput" class="ui black icon button" style="width:40px">
                                <i class="attachment icon"></i>Browse
                            </label>

                            <input type="file" id="fldHiddenFileInput" style="display:none"/>
                        </div>

                        <input type="submit" value="Send" class="ui green submit button" style="margin-top:30px"
                                id="btnSend"/>
                    </form>
                </div>
            </div>

            <div class="ui segment" id="result">
                <h4 class="ui top attached header">
                    Creation Result
                </h4>

                <div class="ui segment attached">
                    <textarea style="width:100%; height:400px; font-family: monospace"></textarea>
                </div>
            </div>
        </div>
    </div>

    <script src="../style/javascript/jquery-1.11.1.min.js"></script>
    <script>
        $('#fldHiddenFileInput').change(function(){
            var fileName = $(this).val().split('\\').pop();
            $('#filename').val(fileName);
        });

        $('#menutier1').find('a').click(function(){
            $('#menutier1').find('a').each(function(){
                $(this).removeClass('active');
            });

            $(this).addClass('active');
        });

        $('#menutier2').find('a').click(function(){
            $('#menutier2').find('a').each(function(){
                $(this).removeClass('active');
            });

            $(this).addClass('active');
        });

        $('#backendsBtn').click(function(){
            $('#menutier2').html(
            '<a class="active item">Search</a>\
            <a class="item">Add</a>\
            <a class="item">Remove</a>'
            )
        });


        $('#mainPageBtn').click(function(){
            $('#menutier2').html('<a class="item">&nbsp;</a>');
        });


        $('#btnSend').click(function(e){
            e.preventDefault();

            var files = $('#fldHiddenFileInput')[0].files;

            if (files.length == 0){
                alert("No file selected!");
                return;
            }

            console.log(files[0]);
            var data = new FormData();
            data.append('xmlFile', files[0]);

            $.ajax({
                type: "POST",
                url: '/virtual-sensor-batch-creation-old',
                data: data,
                processData: false,
                success: function(e){
                    console.log(e);
                    $('#result').show().find('textarea').val(e);

                }
            });
        });

        $('#result').hide();
    </script>
</body>
</html>